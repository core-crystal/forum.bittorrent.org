<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>forum.bittorrent-archive.mythra.dev / DHT Hacking and Security</title>
<link rel="stylesheet" type="text/css" href="style/Kontrast.css" />
</head>
<body>

<div id="punwrap">
<div id="punviewtopic" class="pun">

<div id="brdheader" class="block">
	<div class="box">
		<div id="brdtitle" class="inbox">
			<h1><span>forum.bittorrent-archive.mythra.dev</span></h1>
			<p><span>BitTorrent.org community</span></p>
		</div>
		<div id="brdmenu" class="inbox">
			<ul>
				<li id="navindex"><a href="index.php">Index</a></li>
				<li id="navextra1"><a href="http://forum.bittorrent-archive.mythra.dev">Homepage</a></li>
				<li id="navextra2"><a href="irc://irc.freenode.net/bittorrent">IRC</a></li>
				<li id="navuserlist"><a href="userlist.php">User list</a></li>
				<li id="navrules"><a href="misc.php?action=rules">Rules</a></li>
				<li id="navsearch"><a href="search.php">Search</a></li>
				<li id="navregister"><a href="register.php">Register</a></li>
				<li id="navlogin"><a href="login.php">Login</a></li>
			</ul>
		</div>
		<div id="brdwelcome" class="inbox">
			<p>You are not logged in.</p>
		</div>
	</div>
</div>

<div id="announce" class="block">
	<h2><span>Announcement</span></h2>
	<div class="box">
		<div class="inbox">
			<div>Posting about any illegal sharing of copyrighted content is strictly forbidden.</div>
		</div>
	</div>
</div>

<div class="linkst">
	<div class="inbox">
		<p class="pagelink conl">Pages: <strong>1</strong></p>
		<p class="postlink conr">&nbsp;</p>
		<ul><li><a href="index.php">Index</a></li><li>&nbsp;&raquo;&nbsp;<a href="viewforum.php?id=25">BEPs</a></li><li>&nbsp;&raquo;&nbsp;DHT Hacking and Security</li></ul>
		<div class="clearer"></div>
	</div>
</div>

<div id="p820" class="blockpost rowodd firstpost">
	<h2><span><span class="conr">#1&nbsp;</span><a href="viewtopic.php?pid=820#p820">2009-11-28 11:31:29</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90545">Fredrik Neij</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3>DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>Me and a few others have been abusing, hacking and doing all the stuff you are not supposed to do with DHT, it turns out it's scary, it's almost at the state SMTP was at in the early days of the 90s, aka wide open for abuse.<br /><br />It turns out you can use DHT enabled clients for all sorts of stuff, like using them as an amplifier to a DDoS, as well as an initiators, and even worse you could easily disrupt the established pseudo network.<br /><br />We have discovered alot of stuff you can use the DHT network to that it were never intended to be used for.<br /><br />We found alot of data pointing to that well funded abusive operations, such as governments (like Iran or China) or lobby organizations could easily cause, at least at the info_hash level (or at least the first 32bits), globally, entirely or partially disruptions of the DHT network operations.<br /><br />Is there a secure invite-only place to discuss this, before too many others discovers the abuse potential of the current state of the HUGE resource that the DHT network is, and could become in the hands of abusers.<br /><br />With the amount DHT enabled clients rapidly growing, and by far overshadows any malicious network in numbers, the security issues should be taken care of before someone that is not all that friendly discovers this potential.<br /><br />But all the problems and way to abuse them, should defiantly not be discussed in public until there is a solution all can agree on.<br /><br />Any ideas suggestions, or maybe there is other groups already looking in to this, do you need input, we are doing some weird stuff I bet you never tough of.<br /><br />// Fredrik</p>
				</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p821" class="blockpost roweven">
	<h2><span><span class="conr">#2&nbsp;</span><a href="viewtopic.php?pid=821#p821">2009-11-28 18:00:27</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=89618">The 8472</a></strong></dt>
					<dd class="usertitle"><strong>Azureus Developer</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>As requested, I created an appropriate section for such discussions.<br /><br />Though most security flaws of the DHT are quite obvious and have already been pointed out in IRC discussions, so they're not really secret.</p>
				</div>
				<div class="postsignature"><hr />Az dev</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p823" class="blockpost rowodd">
	<h2><span><span class="conr">#3&nbsp;</span><a href="viewtopic.php?pid=823#p823">2009-11-28 20:18:52</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90637">Choy Kloun</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>What I'd like to do is a good study of certain saboteurs of free information exchange that are known to harass P2P services. Didn't Fredrik have some data on them? We should set up a couple of logging nodes at strategic &quot;locations&quot; in DHT and see what turns up.<br /><br />Certain of the current DHT deficiencies may very well be positive when it comes to chasing certain elements away from messing with DHT. :-)<br /><br />And having some monitoring established should also give a good early warning if someone starts to do nasty things to the actual DHT structure. It could even be possible to do automated counter-measures for certain kinds of misbehavior.<br /><br />As DHT is today I would compare it to Usenet/NNTP. Maybe DHT needs its own equivalency of cancelbots ... ?<br /><br />There are some fixes that can be implemented in the current clients without breaking compatibility though. I'll play around a bit using my DHT implementation. <br /><br /><br />However - I must add that there is one issue that needs to be dealt with ASAP, and that's the various possibilities for DDoS amplification / generation. The millions of active BT clients with DHT support can pose a very real threat to the rest of the Net. Not to mention what widespread attacks and the following publicity would do for the future of BT.<br />I can tell from personally defending against them that the existing amplified DDoS attacks, such as those using DNS, are very real and amongst the more difficult to defend against. And unlike DNS, BT has a lot of people who certainly wouldn't miss it and certain providers would be more than happy to block it totally, etc.</p>
					<p class="postedit"><em>Last edited by Choy Kloun (2009-11-28 21:19:03)</em></p>
				</div>
				<div class="postsignature"><hr />ឧងមិនចូលចិត្តភិទភិតេ?ចូយមាឧង!</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p828" class="blockpost roweven">
	<h2><span><span class="conr">#4&nbsp;</span><a href="viewtopic.php?pid=828#p828">2009-11-29 07:31:31</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90623">adrian</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>&gt; It turns out you can use DHT enabled clients for all sorts of stuff, like using them as an<br />&gt; amplifier to a DDoS, as well as an initiators<br /><br />How would that work? Sending invalid 'values' doesn't do much harm (as you would also have to perform a sybil attack and even then you won't do much bad). Sending bad 'nodes' values will do even less harm.<br /><br />&gt; and even worse you could easily disrupt the established pseudo network.<br /><br />..or hijack it (-&gt; sybil) : <a href="http://it.slashdot.org/article.pl?sid=08/11/08/1437225" rel="nofollow">http://it.slashdot.org/article.pl?sid=08/11/08/1437225</a> (the storm worm uses/used the overnets Kademlia network)<br /><br /><br />@ The 8472<br /><br />&gt; As requested, I created an appropriate section for such discussions.<br /><br />Would you mind letting me (and other DHT implementers) know where it is? :-)<br /><br />Regards,<br /> Adrian</p>
				</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p829" class="blockpost rowodd">
	<h2><span><span class="conr">#5&nbsp;</span><a href="viewtopic.php?pid=829#p829">2009-11-29 07:31:38</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90623">adrian</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>(deleted due to forum-software hiccup)</p>
					<p class="postedit"><em>Last edited by adrian (2009-11-29 07:32:44)</em></p>
				</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p830" class="blockpost roweven">
	<h2><span><span class="conr">#6&nbsp;</span><a href="viewtopic.php?pid=830#p830">2009-11-29 11:07:54</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90637">Choy Kloun</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>Obvious way of using DHT to aid in a (D)DoS attack: Use DHT nodes as amplifiers in a UDP flood. You can achieve quite decent multiplication ratios, and there are literally millions of globally distributed easy-to-locate nodes to use for it.<br />There are also lots of less obvious ways. I'm planning to perform some testing with actual real-life nodes and see which methods are the most viable.<br />Considering the huge amount of nodes available and the small amount of communications needed, even quite small rates of traffic from each node could wreak mayhem on the target.<br /> <br />One simple thing that really, really should be implemented is making sure the node never sends a response larger than the incoming packet (or high rates, etc) before it knows it has two-way contact with the other end. This is easy to verify if you use transaction IDs with sufficient entropy.<br />A good addition to the protocol would be a response that tells the sending node to cease sending ALL packets to the host for a (quite long) period of time. Obviously you need proper authentication, but that kinda solves itself with high transID entropy.<br />This would make life easier for those defending against any attacks. When we received multi-gigabit week-long DNS amplifier attacks I sure wished DNS had such a feature...<br />Consider it a &quot;good neighbor&quot; feature. Doing your best protocol/implementation-wise to be nice to your fellow Internet users is a very, very good thing.<br /><br /><br />There isn't anything in DHT that makes it an <em>especially</em> powerful DoS aid. The threat comes from the huge user base and the ease of locating nodes.<br />Also, there is a certain group of well-funded attackers with a clear motive for disrupting all P2P file sharing, especially DHT which lacks a single point to attack with legal or other means. This group is best known as the MAFIAA, and they have a long well-documented history of using very dirty tactics including outright technical attacks. Also consider that widespread abuse of DHT in DoS attacks would provide them with a powerful argument for blocking/banning DHT and related protocols.</p>
					<p class="postedit"><em>Last edited by Choy Kloun (2009-11-29 11:36:56)</em></p>
				</div>
				<div class="postsignature"><hr />ឧងមិនចូលចិត្តភិទភិតេ?ចូយមាឧង!</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p831" class="blockpost rowodd">
	<h2><span><span class="conr">#7&nbsp;</span><a href="viewtopic.php?pid=831#p831">2009-11-29 11:51:10</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90623">adrian</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>&gt; Use DHT nodes as amplifiers in a UDP flood.<br /><br />And how would you do that?<br /><br />- A $victim will only send data to $target by itself if it has been added to its own routing table.<br />Getting $target into $victims routing table isn't so easy because you'd first have to trick $victim into asking you about data.<br /><br />- Spoofing UDP sources also doesn't sound like a good idea because most edge routers filter such stuff and it's very inefficent (1 ping -&gt; 1 pong )<br /><br />&gt; There are also lots of less obvious ways.<br />Please enlighten me. I fail to see any efficient ways to perform a DDOS via Kademlia.<br /><br /><br />&gt; This is easy to verify if you use transaction IDs with sufficient entropy.<br /><br />Transaction IDs have no meaning to a peer that responds to a query.<br /><br />Regards,<br /> Adrian</p>
				</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p832" class="blockpost roweven">
	<h2><span><span class="conr">#8&nbsp;</span><a href="viewtopic.php?pid=832#p832">2009-11-29 12:29:56</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90623">adrian</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>btw: I tested what would happen if $evil_node adds the IP of $victim to each find_node/get_peers reply.<br /><br />I let it run for about 5 minutes ($evil_node is online 24/7h and well known in the network)<br /><br />Grand totals:<br />----------------------------------------------------------------------<br />- UDP packets sent by $evil_node: 944<br />- UDP packets received by $victim: 222 (28054 bytes)<br />----------------------------------------------------------------------<br /><br />You might get slightly better results if $evil_node was placed in a 'hot-spot' but even then it wouldn't be able to do much harm.</p>
				</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p834" class="blockpost rowodd">
	<h2><span><span class="conr">#9&nbsp;</span><a href="viewtopic.php?pid=834#p834">2009-11-29 14:08:21</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=89618">The 8472</a></strong></dt>
					<dd class="usertitle"><strong>Azureus Developer</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<blockquote><div class="incqbox"><h4>adrian wrote:</h4><p>&gt; As requested, I created an appropriate section for such discussions.<br /><br />Would you mind letting me (and other DHT implementers) know where it is? :-)<br /><br />Regards,<br /> Adrian</p></div></blockquote><p>Well, idk who is who, so i only added the people who i knew to that user group.<br /><br /><br /><br /><br />Back to the topic. Drastic, i.e. incompatible changes to the protocol need proof that there is a serious security issue that needs to be fixed asap. Otherwise we can only provide implementation advise to make implementations less exploitable.</p>
				</div>
				<div class="postsignature"><hr />Az dev</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p835" class="blockpost roweven">
	<h2><span><span class="conr">#10&nbsp;</span><a href="viewtopic.php?pid=835#p835">2009-11-29 17:00:59</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90637">Choy Kloun</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>Spoofing UDP sources is very much doable and many edge routers (outside of broadband connections and such) certainly don't filter it. If someone doubts this I'm more than glad to provide you with a couple of hundred Mbps worth of fully spoofed UDP packets :-).<br />Globally, filtering of spoofed traffic is more or less a joke.<br /><br />Spoofed query which results in a larger response means attack amplification - simple.<br />One very quick example - I just checked the debug traffic dumps from my implementation, and the 107 byte get_peers query it sends generates a 308 byte response.<br /><br />It also provides the attacker with excellent distribution/spreading of the traffic sources, which is very useful in making routing-based attack mitigation much more difficult. Just using get_peers would turn an attack from a single source with a gigabit connection (not exactly rocket science to get access to for any bored kid, unlike breaking into lots of widely distributed hosts) into a poly-gigabit flood from sources all over the Net. Or maybe with sources selected to fill the weakest transit connections, etc.<br /> <br /><br />Like I said, when I get the time and have finished what I'm currently working on I'll do some testing and see what if any other techniques are useful for real-life attacks. Global DHT is obviously a very complex organism (sum bigger than the parts) so fully predicting all behavior almost involves chaos theory :-).<br /> <br /><br />&quot;Transaction IDs have no meaning to a peer that responds to a query.&quot;<br />Well, duuh :-).<br />I think I wasn't being clear and/or we had some line noise :-). The purpose is for the node which sends the data to verify it in the response, obviously. Even if it normally only would receive queries from that node it can simply send a ping query to perform the verification.<br />Or are you referring to the 'shut up' packets? Obviously you need to take some liberties for that special case if you don't want to add a new 'shut up cookie' to the protocol (doesn't sound like a bad idea to me actually - an entry that's guaranteed to be high entropy wouldn't hurt for possible future protocol expansion when it comes to things such as authentication and crypto).<br /><br />Obviously breaking backwards compatibility isn't something to be done lightly. But there are certainly small but relevant improvements (like those I suggested here) that can be done without breaking anything, or negatively affecting performance/functionality in any way. I'll start writing up a list.<br /><br />I do admit that I'm a bit jumpy at times when it comes to DDoS :-) but I have the excuse of having several years experience battling attacks, some of them very creative and/or performed by very motivated attackers (FSB, the Russian security service being one of several examples).<br />For example, I can recall many cases where our defense would've been made much more difficult if the attack had been geographically distributed in the ways DHT enables.<br />And certainly there's no harm in being the best possible neighbor.<br /><br /><br />And by the way, if my explanations aren't the clearest I apologize - too much work at the moment...</p>
					<p class="postedit"><em>Last edited by Choy Kloun (2009-11-29 17:57:27)</em></p>
				</div>
				<div class="postsignature"><hr />ឧងមិនចូលចិត្តភិទភិតេ?ចូយមាឧង!</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p837" class="blockpost rowodd">
	<h2><span><span class="conr">#11&nbsp;</span><a href="viewtopic.php?pid=837#p837">2009-11-29 18:51:51</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=89618">The 8472</a></strong></dt>
					<dd class="usertitle"><strong>Azureus Developer</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>Currently there are about 5M DHT nodes, assuming... regular DHT traffic is usually 3kB/s in each direction (more for very long-lived nodes). So if we would rate-limit nodes generally to 10kB/s that would be result in a max. aggregate bandwidth of 50 GB/s.<br /><br />The question is can you actually harness that much... or even a fraction of that? The DHT is very transient, as attacker you have to maintain a list of live, reachable nodes that you can use to amplify your traffic. Then there is packet loss which cuts into your amplification.<br /><br /><br />The other issue here is that the threat model is limited. You assume that your attacker already has access to a 1Gbit/s internet connection and can spoof source addresses but that this alone is not enough to run a DoS attack. So you probably need a pretty big target...<br /><br /><br /><br />Implementation optimizations such as rate-limiting requests per /24 instead of globally are the least-intrusive adjustments to prevent such attacks imo.<br /><br /><br />3-way-handshakes to check the source address just to reply to a find-nodes or get-peers request on the other hand is highly unlikely to happen. I don't think emule's Kad network has such security measures either.<br /><br /><br /><br />And last but not least we also have to consider if we actually want to defend against such an attack since it is a high impact low probability event. The resources to mount such an attack are considerable and will most certainly trigger an investigation within the affected ISPs. I mean, i haven't heard of any 1Gbit/s &gt; attacks that lasted for a significant amount of time without the source being identified and shut down.</p>
				</div>
				<div class="postsignature"><hr />Az dev</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p840" class="blockpost roweven">
	<h2><span><span class="conr">#12&nbsp;</span><a href="viewtopic.php?pid=840#p840">2009-11-29 23:23:19</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90623">adrian</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p><em> @ Choy Kloun </em><br /><br />&gt; If someone doubts this I'm more than glad to provide you with a couple of hundred Mbps <br />&gt; worth of fully spoofed UDP packets :-).<br /><br />No thanks ;-) <br /><br />&gt; Spoofed query which results in a larger response means attack amplification - simple.<br /><br />How does DNS/NTP solve this issue?<br /><br /><br />&gt; I just checked the debug traffic dumps from my implementation, and the 107 byte <br />&gt; get_peers query it sends generates a 308 byte response.<br /><br />Ok: So you gain 2.8x . Well: Limiting the payload sent to unverified nodes would be possible without breaking any existing implementation but it might slow down the whole DHT. Hmm...<br /><br />&gt; I think I wasn't being clear and/or we had some line noise :-).<br />&gt; The purpose is for the node which sends the data to verify it in the response, obviously.<br /><br />Ah ok.. got it after re-reading your post.<br /><br /><br /><em> @The 8472 </em><br /><br />&gt; You assume that your attacker already has access to a 1Gbit/s internet<br />&gt; connection and can spoof source addresses but that this alone is not<br />&gt; enough to run a DoS attack.<br /><br />At least it would be enough to kill many smaller sites:<br />You'd get ~ 2.8Gbit/s of traffic and it would be very hard to mitigate such an attack because it's spread across so many ISPs / AS<br /><br /><br />&gt; Implementation optimizations such as rate-limiting requests per /24 instead of<br />&gt; globally are the least-intrusive adjustments to prevent such attacks imo.<br /><br />This would (imho) be much better than implementing a magic shut-up packet.<br /><br /><br />&gt; I mean, i haven't heard of any 1Gbit/s &gt; attacks that lasted for a significant<br />&gt; amount of time without the source being identified and shut down.<br /><br />I've used to work for a big ISP and believe me: ~3Gbit/s DDOS attacks are 'daily business'. <br /><br /><br />&gt; Well, idk who is who, so i only added the people who i knew to that user group.<br /><br />I'm the author of Bitflu and the owner of the 6to4 node in dht.wifi.pps.jussieu.fr<br /><br />Regards,<br /> Adrian</p>
				</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p841" class="blockpost rowodd">
	<h2><span><span class="conr">#13&nbsp;</span><a href="viewtopic.php?pid=841#p841">2009-11-30 03:20:49</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90637">Choy Kloun</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>As for NTP, the finer details of that protocol has escaped from my memory.<br />DNS doesn't protect against it in any way, and DNS amplifier attacks are occasionally a major headache. But it's somewhat mitigated by the fact that you aren't going to find a lot of DNS queries that generate responses with any significant amplification - the amplifier attacks use open resolvers so that the attacker can produce crafted DNS data (usually TXT or similar records filling the maximum EDNS0 packet size).<br />None of those protocols are running on 5M servers which are purposefully designed to distribute their IP address, though...<br /><br />Obviously making DHT a better citizen is something that would be done with several small fixes and not one/a few magic bullet(s). When I suggest modification X, it doesn't exclude !X :-).</p>
				</div>
				<div class="postsignature"><hr />ឧងមិនចូលចិត្តភិទភិតេ?ចូយមាឧង!</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p842" class="blockpost roweven">
	<h2><span><span class="conr">#14&nbsp;</span><a href="viewtopic.php?pid=842#p842">2009-11-30 03:20:54</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90637">Choy Kloun</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>As for NTP, the finer details of that protocol has escaped from my memory.<br />DNS doesn't protect against it in any way, and DNS amplifier attacks are occasionally a major headache. But it's somewhat mitigated by the fact that you aren't going to find a lot of DNS queries that generate responses with any significant amplification - the amplifier attacks use open resolvers so that the attacker can produce crafted DNS data (usually TXT or similar records filling the maximum EDNS0 packet size).<br />None of those protocols are running on 5M servers which are purposefully designed to distribute their IP address, though...<br /><br />Obviously making DHT a better citizen is something that would be done with several small fixes and not one/a few magic bullet(s). When I suggest modification X, it doesn't exclude !X :-).</p>
				</div>
				<div class="postsignature"><hr />ឧងមិនចូលចិត្តភិទភិតេ?ចូយមាឧង!</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p843" class="blockpost rowodd">
	<h2><span><span class="conr">#15&nbsp;</span><a href="viewtopic.php?pid=843#p843">2009-11-30 03:42:40</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90580">jch</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<blockquote><div class="incqbox"><p>Use DHT nodes as amplifiers in a UDP flood. You can achieve quite decent multiplication ratios,</p></div></blockquote><p>If I'm not mistaken, you get an amplification factor of 1 in packet count, and roughly 3 in packet size.&nbsp; You'll get much better results with DNS, especially once people start implementing IPsec.<br /><br />I'm much more concerned about the damage that the so-called security experts do by causing useless panics (I still grieve for RH0).<br /><br /></p><blockquote><div class="incqbox"><p>As requested, I created an appropriate section for such discussions.</p></div></blockquote><p>Unless there's good reason not to, let's discuss that in public.<br /><br />--Juliusz</p>
				</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p844" class="blockpost roweven">
	<h2><span><span class="conr">#16&nbsp;</span><a href="viewtopic.php?pid=844#p844">2009-11-30 04:58:33</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90637">Choy Kloun</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>And idiots causing panic relates to people who have mitigated far too many DDoS attacks discussing possible protocol and implementation issues with developers in what way, exactly?<br /><br />Edit to clarify: If anyone has interpreted anything I've said as panic-mongering, I apologize for that. Not at all my intention. Now lets get on with identifying problems and discussing relevant solutions!<br />I'll also submit a proposal for DHT protocol encryption/obfuscation shortly, but that's not relevant for this thread.</p>
					<p class="postedit"><em>Last edited by Choy Kloun (2009-12-01 11:39:14)</em></p>
				</div>
				<div class="postsignature"><hr />ឧងមិនចូលចិត្តភិទភិតេ?ចូយមាឧង!</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p851" class="blockpost rowodd">
	<h2><span><span class="conr">#17&nbsp;</span><a href="viewtopic.php?pid=851#p851">2009-12-03 15:34:21</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90580">jch</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<blockquote><div class="incqbox"><p>Now lets get on with identifying problems and discussing relevant solutions!</p></div></blockquote><p>Yes, let's.&nbsp; What amplification factor are you claiming exactly?<br /><br />--Juliusz</p>
				</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p852" class="blockpost roweven">
	<h2><span><span class="conr">#18&nbsp;</span><a href="viewtopic.php?pid=852#p852">2009-12-04 16:04:57</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90637">Choy Kloun</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>Major issue when it comes to amplification whne doing simple spoofed queries isn't some extreme ratio (the most basic abuse would result in roughly 3x as has already been stated, although it should be possible to achieve a higher ratio), but the fact that it provides really easy distribution and targeting geographic/network-wise, because of the large number of clients and the ease of locating them.<br /><br />This is very effective at bypassing several important DDoS mitigation methods <br />Even not taking that issue into account millions of nodes that provides decent amplification and are easily located is definitely useful for an attacker.<br /><br />Unfortunately I got sick for two weeks and I'm having a hell of a time clearing up the huge backlog of work that built up during this time, so I still haven't done the testing I plan to do so we can see some empirical evidence here.<br />I have to eat, and while&nbsp; ស្រុកខ្មែរ is a wonderful country in many ways it certainly doesn't have a dole office :-). My savings are a bit thin because of this so I need to work my ass off for the next couple of weeks.<br /><br />Will get back to the DHT lab as soon as I have some spare time.<br /><br /><br />Anyways, my basic point is still that some simple non-invasive measures can effectively prevent this and other DHT-based attacks. I don't see any reason not to be the best possible Internet citizen in such a widely used protocol.<br /><br />And please, try to be a bit nicer. Is this the way you greet all proposals dealing with something new and unknown? I understand that my intentions could have been misunderstood as misinformed scare-mongering, and that not everyone in this thread do know enough of my background to verify that I'm not some random hobo talking out of my ass, but isn't this cleared up by now? If I've misread your intended tone then I apologize in advance.<br />I'm just talking about one participant here - the others have brought up valid issues / questions which is exactly what I want.<br /><br />I find decentralized networking and self-organizing systems extremely interesting, and on top of this I do really, really like BT and DHT a lot. I'd hate to see DHT being abused on a large scale which IMHO is a real possibility and would cause great harm not only to the DHT network but also to a large amount of third parties.</p>
					<p class="postedit"><em>Last edited by Choy Kloun (2009-12-04 16:41:58)</em></p>
				</div>
				<div class="postsignature"><hr />ឧងមិនចូលចិត្តភិទភិតេ?ចូយមាឧង!</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p855" class="blockpost rowodd">
	<h2><span><span class="conr">#19&nbsp;</span><a href="viewtopic.php?pid=855#p855">2009-12-06 14:41:34</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90580">jch</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>&gt; Is this the way you greet all proposals dealing with something new and unknown?<br /><br />No.&nbsp; This is the way I greet people who start by telling me about China and Iran and how evil they are, and then suggest that we create a private forum to discuss without the hoi polloi barging in.<br /><br />--Juliusz</p>
				</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p856" class="blockpost roweven">
	<h2><span><span class="conr">#20&nbsp;</span><a href="viewtopic.php?pid=856#p856">2009-12-06 16:49:27</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=89618">The 8472</a></strong></dt>
					<dd class="usertitle"><strong>Azureus Developer</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>I suggest you refrain from meta-discussion, politics, personal crusades etc. and only stick to the protocol and changes at question.<br />What you're doing will not lead anywhere.</p>
				</div>
				<div class="postsignature"><hr />Az dev</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p858" class="blockpost rowodd">
	<h2><span><span class="conr">#21&nbsp;</span><a href="viewtopic.php?pid=858#p858">2009-12-07 01:13:16</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90623">adrian</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>&gt; I suggest you refrain from meta-discussion, politics, personal crusades etc. [...]<br />&gt; What you're doing will not lead anywhere.<br /><br />To be honest: At least the first few posts sounded like the 'symantec-salesforce' tried to invade the forum in order to spew panic. And creating a secret place that excludes other DHT implementors (such as /me and jch) isn't a nice thing to do either.<br /><br /><br />But back to the topic: Let's summarize what we got so far:<br /><br />-&gt; Fredrik and Choy stated that the DHT network could be abused to start a DDOS with ~3x amplification factor IF you are able to spoof UDP Source addresses.<br /><br />-&gt; You could do exactly the same using public DNS / NTP / $anything_that_uses_udp Servers but it would be harder to mitigate an attack that uses the DHT.<br /><br />-&gt; Implementing a rate-limit could help but calculating the upper limit would be tricky (measuring 'normal' traffic while running doesn't work because the node could be under attack from the beginning)<br /><br />Anything else?</p>
				</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p861" class="blockpost roweven">
	<h2><span><span class="conr">#22&nbsp;</span><a href="viewtopic.php?pid=861#p861">2009-12-09 22:23:17</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90637">Choy Kloun</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>&gt; To be honest: At least the first few posts sounded like the 'symantec-salesforce' tried to invade the <br />&gt; forum in order to spew panic.<br /><br />Yes - I totally agree here. Fredrik is not good at expressing himself in writing. And you kinda must understand the background - he'd seen me and others do lots of odd stuff with DHT and he's a really, really, skilled tech guy in a lot of ways but not when it comes to judging the severity of stuff like this.<br />We have done a range of things from severe to fun harmless experiments using DHT for stuff it wasn't intended for and just by filtering that through a third party and then adding me being pretty blunt when it comes to (D)DoS attacks simply from having spent many late nights defending against big attacks made possible by other protocol defects... well, you don't get a good start of a thread unless everyone involved knows each other from before.<br /><br />I guess I kinda apologize on his behalf, without asking him first :-). And again for anything I've writtent that can be perceived in the wrong way.<br /><br />Hell, I quit a promising career in the formal computer security industry (consulting doing pentesting and such (even pentesting in itself as its often done is quite a worthless way of testing high-level security!)) largely because 99.999% of the industry is Symantec/ISS/WeKnowJackShitButWeHaveAGoodSalesTeamAndOur&quot;Experts&quot;HaveCrispNewSuitsBigCorp. Large parts of the computer security industry is at the end of the day simply parting fools from their money. I'd even call it a fraud. I couldn't look myself in the mirror knowing I was part of that.<br /><br />Computer security is still part of much of the work I do but it's totally honest work that more or less speaks for itself for the client. If I mess up doing some of my consulting jobs, the result is that literally millions of dollars and potentially human lives can be lost. Not that some bean-counter or salesdroid just has to tell a little white lie to a customer and tell them that they didn't buy a product/service that was expensive enough. I have so many horror stories from the industry to tell if anyone wants to listen... Everything from awards being given to products that would be technically impossible to advisories about non-existing vulnerabilities.<br /> <br />But as I'm kinda unknown here except by the few who know me, stuff like that obviously isn't knowledge amongst many of the participants in the thread and I'm not the most reliably diplomatic guy either. I try to always be modest about my skill level though, when it isn't needed to prove a point.<br /><br />&gt; And creating a secret place that excludes other DHT implementors (such<br />&gt; as /me and jch) isn't a nice thing to do either.<br /><br />Not my decision (I joined here after the secret society was set up and everyone got their DHT Security Stonecutter rings and had to do the secret initiation ritual <img src="img/smilies/big_smile.png" width="15" height="15" alt="big_smile" />), but doing it with totally full disclosure at this stage would potentially cause what we are trying to avoid in the future. Hell, full disclosure is another thing that's wrong with the computer security industry today as it has basically turned into half scaremongering and half extortion. <br />And to be honest, excluding jch seems like a good idea until we make up, shake hands and get on a friendly basis :-) And maybe just agree to disagree instead of engaging in flame wars if we can't get our respective points across to each other...<br /><br /><br /><br />To add to your list:<br />- I think NTP solves this actually. Atleast I have a recollection of this being the case. Haven't had time to do a single piece of BT/DHT-related work since my last post in this thread.<br />- Incoming DNS attacks are much easier to block at the router ACL (done in ASIC) level (constant source port). You could block ALL traffic from port 53 to say a hosting network if all servers use one specific resolver being exempted from this block (potentially being on a totally separate network <br />- No ISP would get the idea of totally blocking DNS and NTP and there's no one that has political motives for them doing so, but DHT on the other hand...<br />- Clients could use the transID and keep state (simple hash table, O(1)) to verify that it has two-way&nbsp; communications, and before it does at least apply strict rate limiting. At this level it should be possible to do so as we are talking a single packet exchange. Limiting SHOULD be done on a network (/24 or possibly even shorter prefix). And/or even make sure you never send a response bigger than the query.<br />This should be doable while retaining full backwards compatibility. I don't have delusions of grandeur and think we can make millions of users all upgrade at once just because someone comes up with a good idea.<br /><br />- More research with actual real live nodes is needed to see what other attacks are practical (we have a few in store)<br /><br />- Not only discussing DoS issues, but also attacks targeted against the DHT network itself. Think MAFIAA deciding that DHT is the next big threat to their antiquated business models. I think I already mentioned this, but I have a view where DHT just like Usenet could be in need of active defensive (or offensive) measures managed by trusted users.<br />Maybe there will be an equivalent to killfiles and cancelbots in the DHT network in the future ?<br />This brings me back to my previous point. And the last sentence of my first.<br /><br />- Later on, when we've reached something concrete from this, maybe get on to how to prevent ISP blocking/manipulation of DHT traffic. Does it suffice to say that the majority of traffic blocked in China is BT traffic, and it's certainly not because of piracy ... ?<br /><br />No, I'm not going &quot;China is evil, Iran is evil, blah blah blah blah lets be a liberal do-gooder&quot; here. I'll temporarily suspend my modesty again and say that I probably have by far the best view of the situations in those countries of anyone remotely active in this thread. As for China evil blah blah, hasn't certain people even bothered to notice that my nickname and signature are both in an Asian language? A language spoken in one specific country close to China with a large Chinese population and a sizable Chinatown in the middle of the capital?<br /><br />(My signature says approximately &quot;If you don't like P2P, then go to hell&quot; but in a much ruder way than it's possible to say it in English, and with a creative transliteration of the English pronounciation of P2P... The precise level of politeness used the one you'd use if were talking to a child or maybe someone at the higher levels of society addressing a beggar who's pestering him. Not only computer languages are fascinating! <br />នីងខ្ងំនិយាយភាសាខ្មែរតែខ្ងំមីនសរសេរល្អអតេ​)</p>
				</div>
				<div class="postsignature"><hr />ឧងមិនចូលចិត្តភិទភិតេ?ចូយមាឧង!</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p862" class="blockpost rowodd">
	<h2><span><span class="conr">#23&nbsp;</span><a href="viewtopic.php?pid=862#p862">2009-12-09 23:52:45</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=89618">The 8472</a></strong></dt>
					<dd class="usertitle"><strong>Azureus Developer</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>Uhm, that post still consists to &gt; 50% of personal anecdotes and meta-discussion. Again, please stick to the topic.</p>
				</div>
				<div class="postsignature"><hr />Az dev</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p863" class="blockpost roweven">
	<h2><span><span class="conr">#24&nbsp;</span><a href="viewtopic.php?pid=863#p863">2009-12-10 07:34:48</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90637">Choy Kloun</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>I think all of it had a point, at least the first paragraph (clarifying why the thread started the wrong way) and the last paragraph (why there are good reasons to believe China will start blocking/attacking DHT) and honestly- I've never had any significant number of developers get together in the same place without sharing a lot of anecdotes. But you're the boss, and yes, it certainly strayed off-topic.<br />I'm still bitter with a certain industry though. Extremely.<br /><br />So, do we have any comments on the actual bullet points? Just read the parts starting with '-'.<br />Less talk, more chalk!</p>
					<p class="postedit"><em>Last edited by Choy Kloun (2009-12-10 07:40:31)</em></p>
				</div>
				<div class="postsignature"><hr />ឧងមិនចូលចិត្តភិទភិតេ?ចូយមាឧង!</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div id="p864" class="blockpost rowodd">
	<h2><span><span class="conr">#25&nbsp;</span><a href="viewtopic.php?pid=864#p864">2009-12-10 10:04:33</a></span></h2>
	<div class="box">
		<div class="inbox">
			<div class="postleft">
				<dl>
					<dt><strong><a href="profile.php?id=90623">adrian</a></strong></dt>
					<dd class="usertitle"><strong>Member</strong></dd>
					<dd class="postavatar"></dd>
				</dl>
			</div>
			<div class="postright">
				<h3> Re: DHT Hacking and Security</h3>
				<div class="postmsg">
					<p>&gt; And to be honest, excluding jch seems like a good idea until we make up,<br />&gt; shake hands and get on a friendly basis :-)<br /><br />jch is a friendly person and it just appers that he *also* got pissed off when someone tried to hijack this thread into a private forum.<br /><br />Back to the topic:<br /><br /># Verify each client:<br />&gt; - Clients could use the transID and keep state (simple hash table, O(1)) to verify that it has<br />&gt; two-way&nbsp; communications,<br /><br />I don't really like this approach: Having to verify EACH client doing a 'q' query has some bad downsides:<br /><br /> - It generates a lot of (otherwise unneeded) UDP-Traffic<br /> - The client needs to maintain yet another hashtable, creating a new attack vector:<br />&nbsp; &nbsp; You could just flood/overflow a clients table by using spoofed source adresses.<br /><br /># Cropping responses<br />Adding a 'never send more than you have received' rule would hurt the DHT and treats IPv6 as a 2nd class citizen<br /><br /><br /># Rate limitation:<br /><br />My vote would go to rate limitation:<br /><br /> - Verified clients/peers would have no rate limitation<br /> - The client could pick some random good-nodes to see how much traffic per /24 appears to be normal<br /> - ..and it would then enforce the guessed limit to unverified peers<br /><br />Regards,<br /> Adrian</p>
				</div>
			</div>
			<div class="clearer"></div>
			<div class="postfootleft"><p>Offline</p></div>
			<div class="postfootright"><div>&nbsp;</div></div>
		</div>
	</div>
</div>

<div class="postlinksb">
	<div class="inbox">
		<p class="postlink conr">&nbsp;</p>
		<p class="pagelink conl">Pages: <strong>1</strong></p>
		<ul><li><a href="index.php">Index</a></li><li>&nbsp;&raquo;&nbsp;<a href="viewforum.php?id=25">BEPs</a></li><li>&nbsp;&raquo;&nbsp;DHT Hacking and Security</li></ul>
		<div class="clearer"></div>
	</div>
</div>

<div id="brdfooter" class="block">
	<h2><span>Board footer</span></h2>
	<div class="box">
		<div class="inbox">

			<div class="conl">
				<form id="qjump" method="get" action="viewforum.php">
					<div><label>Jump to
					<br /><select name="id" onchange="window.location=('viewforum.php?id='+this.options[this.selectedIndex].value)">
						<optgroup label="BitTorrent">
							<option value="26">Announcements</option>
							<option value="25" selected="selected">BEPs</option>
							<option value="29">BEP process</option>
							<option value="27">General</option>
							<option value="33">Research Tools</option>
							<option value="32">Cooperation between BitTorrent and ISPs</option>
							<option value="30">Attacks against BitTorrent</option>
							<option value="28">Feature Requests, Found Bugs &gt;&gt;&gt;</option>
					</optgroup>
					</select>
					<input type="submit" value=" Go " accesskey="g" />
					</label></div>
				</form>
			</div>
			<p class="conr">Powered by <a href="http://fluxbb.org/">FluxBB</a></p>
			<div class="clearer"></div>
		</div>
	</div>
</div>

</div>
</div>

<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-116155-1";
_udn = "utorrent.com";
urchinTracker();
</script>

</body>
</html>
